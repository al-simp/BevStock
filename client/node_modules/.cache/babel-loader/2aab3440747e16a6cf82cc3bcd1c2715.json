{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,Fragment}from\"react\";import{Link}from\"react-router-dom\";var UserShowLists=function UserShowLists(_ref){var allLists=_ref.allLists,setListsChange=_ref.setListsChange,stocktake=_ref.stocktake,stocktake_id=_ref.stocktake_id;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),assignedLists=_useState2[0],setAssignedLists=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),stocktakeInstance=_useState4[0],setStocktakeInstance=_useState4[1];//get the lists that have been assigned to the user\nfunction checkAssignedDuties(){return _checkAssignedDuties.apply(this,arguments);}function _checkAssignedDuties(){_checkAssignedDuties=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _stocktake_id,id,body,response,parseRes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_stocktake_id=localStorage.getItem(\"stocktake\");id=localStorage.getItem(\"user\");body={id:id,stocktake_id:_stocktake_id};console.log(body);_context.next=7;return fetch(\"/stocklists/userassignedlists\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)});case 7:response=_context.sent;_context.next=10;return response.json();case 10:parseRes=_context.sent;console.log(parseRes);setAssignedLists(parseRes);if(parseRes.length>0){setAssignedLists(parseRes);}_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](0);console.error(_context.t0.message);case 19:case\"end\":return _context.stop();}}},_callee,null,[[0,16]]);}));return _checkAssignedDuties.apply(this,arguments);}function markComplete(_x){return _markComplete.apply(this,arguments);}function _markComplete(){_markComplete=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){var message,body,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:message=document.getElementById(\"\".concat(id)).value;_context2.prev=1;body={id:id,stocktakeInstance:stocktakeInstance,message:message};_context2.next=5;return fetch(\"/stocktake/markascomplete\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)});case 5:response=_context2.sent;_context2.next=8;return response.json();case 8:setListsChange(true);_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](1);console.error(_context2.t0.message);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[1,11]]);}));return _markComplete.apply(this,arguments);}useEffect(function(){setStocktakeInstance(stocktake_id);setListsChange(false);checkAssignedDuties();},[allLists]);return/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},/*#__PURE__*/React.createElement(\"h4\",null,\"Your Assigned Stock Areas\"),/*#__PURE__*/React.createElement(\"table\",{className:\"table table-bordered\"},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"Stock Area\"),/*#__PURE__*/React.createElement(\"th\",null,\"Count\"),/*#__PURE__*/React.createElement(\"th\",null,\"Manager Message\"),/*#__PURE__*/React.createElement(\"th\",null,\"Your Message\"),/*#__PURE__*/React.createElement(\"th\",null,\"Status\"))),/*#__PURE__*/React.createElement(\"tbody\",null,console.log(assignedLists),assignedLists.map(function(list){return/*#__PURE__*/React.createElement(\"tr\",{key:list.stocklist_id},/*#__PURE__*/React.createElement(\"td\",null,list.stocklist_name),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Link,{to:\"count/\".concat(list.stocklist_id,\"/\").concat(stocktakeInstance),className:\"btn btn-primary\"},\"Count\")),/*#__PURE__*/React.createElement(\"td\",null,list.user_message),list.completed?/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"td\",null,list.completed_message),/*#__PURE__*/React.createElement(\"td\",null,\"Complete\")):/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"textarea\",{id:\"\".concat(list.stocklist_id),cols:\"40\",rows:\"2\"})),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success\",onClick:function onClick(e){markComplete(list.stocklist_id);}},\"Mark as complete\"))));}))))));};export default UserShowLists;","map":{"version":3,"sources":["C:/Users/alans/bevstock/client/src/user/UserShowLists.js"],"names":["React","useState","useEffect","Fragment","Link","UserShowLists","allLists","setListsChange","stocktake","stocktake_id","assignedLists","setAssignedLists","stocktakeInstance","setStocktakeInstance","checkAssignedDuties","localStorage","getItem","id","body","console","log","fetch","method","headers","JSON","stringify","response","json","parseRes","length","error","message","markComplete","document","getElementById","value","map","list","stocklist_id","stocklist_name","user_message","completed","completed_message","e"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Fragment } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst UserShowLists = ({\r\n  allLists,\r\n  setListsChange,\r\n  stocktake,\r\n  stocktake_id,\r\n}) => {\r\n  const [assignedLists, setAssignedLists] = useState([]);\r\n  const [stocktakeInstance, setStocktakeInstance] = useState([]);\r\n\r\n  //get the lists that have been assigned to the user\r\n  async function checkAssignedDuties() {\r\n    try {\r\n      const stocktake_id = localStorage.getItem(\"stocktake\");\r\n      const id = localStorage.getItem(\"user\");\r\n      const body = { id, stocktake_id };\r\n      console.log(body);\r\n      const response = await fetch(\r\n        \"/stocklists/userassignedlists\",\r\n        {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify(body),\r\n        }\r\n      );\r\n      const parseRes = await response.json();\r\n      console.log(parseRes);\r\n      setAssignedLists(parseRes);\r\n      if (parseRes.length > 0) {\r\n        setAssignedLists(parseRes);\r\n      }\r\n    } catch (error) {\r\n      console.error(error.message);\r\n    }\r\n  }\r\n\r\n  async function markComplete(id) {\r\n    const message = document.getElementById(`${id}`).value;\r\n    try {\r\n      const body = { id, stocktakeInstance, message };\r\n      const response = await fetch(\r\n        \"/stocktake/markascomplete\",\r\n        {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify(body),\r\n        }\r\n      );\r\n      await response.json();\r\n      setListsChange(true);\r\n    } catch (err) {\r\n      console.error(err.message);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    setStocktakeInstance(stocktake_id);\r\n    setListsChange(false);\r\n    checkAssignedDuties();\r\n  }, [allLists]);\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"row\">\r\n        <div className=\"col\">\r\n          <h4>Your Assigned Stock Areas</h4>\r\n          <table className=\"table table-bordered\">\r\n            <thead>\r\n              <tr>\r\n                <th>Stock Area</th>\r\n                <th>Count</th>\r\n                <th>Manager Message</th>\r\n                <th>Your Message</th>\r\n                <th>Status</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n            {console.log(assignedLists)}\r\n              {assignedLists.map((list) => (\r\n                <tr key={list.stocklist_id}>\r\n                  <td>{list.stocklist_name}</td>\r\n                  <td>\r\n                    <Link\r\n                      to={`count/${list.stocklist_id}/${stocktakeInstance}`}\r\n                      className=\"btn btn-primary\"\r\n                    >\r\n                      Count\r\n                    </Link>\r\n                  </td>\r\n                  <td>{list.user_message}</td>\r\n                  {list.completed ? (\r\n                    <Fragment>\r\n                      <td>{list.completed_message}</td>\r\n                      <td>Complete</td>\r\n                    </Fragment>\r\n                  ) : (\r\n                    <Fragment>\r\n                      <td>\r\n                        <textarea\r\n                          id={`${list.stocklist_id}`}\r\n                          cols=\"40\"\r\n                          rows=\"2\"\r\n                        ></textarea>\r\n                      </td>\r\n                      <td>\r\n                        <button\r\n                          className=\"btn btn-success\"\r\n                          onClick={(e) => {\r\n                            markComplete(list.stocklist_id);\r\n                          }}\r\n                        >\r\n                          Mark as complete\r\n                        </button>\r\n                      </td>\r\n                    </Fragment>\r\n                  )}\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserShowLists;\r\n"]},"metadata":{},"sourceType":"module"}