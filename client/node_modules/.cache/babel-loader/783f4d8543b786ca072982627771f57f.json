{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{Fragment,useState}from\"react\";import Bottle from\"../../images/beer-bottle.png\";import{useEffect}from\"react\";//Modal that opens when counting a particular product. Preoduct is passed in as props\nvar CountModal=function CountModal(_ref){var product=_ref.product,setProductsChange=_ref.setProductsChange,stocktakeid=_ref.stocktakeid,setQuantity=_ref.setQuantity,setQuantityChange=_ref.setQuantityChange;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),partial=_useState2[0],setPartial=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),tempQuantity=_useState4[0],setTempQuantity=_useState4[1];var stocktake=Number(stocktakeid);//Onchange for partial bottle form field\nvar _onChange=function onChange(e){setPartial(Number(e.target.value));};//Adds partial quantity to temporary quantity\nvar addPartial=function addPartial(){setTempQuantity(Number(tempQuantity+partial));setPartial(0);};//Adds one full bottle to temporary quantity\nvar addOne=function addOne(){setTempQuantity(Number(tempQuantity+1));};//Subtracts one ful bottle from temporary quantity\nvar minusOne=function minusOne(){setTempQuantity(Number(tempQuantity-1));};// Should set product.quantity to the temp quantity value and zero out temp quantity after\nvar setProductQuantity=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(item){var body,response,parseRes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;body={item:item,stocktake:stocktake,tempQuantity:tempQuantity};console.log(body);_context.next=5;return fetch(\"/stocktake/count\",{method:\"PUT\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)});case 5:response=_context.sent;_context.next=8;return response.json();case 8:parseRes=_context.sent;setQuantity(parseRes.rows[0].quantity);_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);console.error(_context.t0.message);case 15:setTempQuantity(0);setProductsChange(true);setQuantityChange(true);case 18:case\"end\":return _context.stop();}}},_callee,null,[[0,12]]);}));return function setProductQuantity(_x){return _ref2.apply(this,arguments);};}();useEffect(function(){},[tempQuantity]);return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-info\",\"data-toggle\":\"modal\",\"data-target\":\"#id\".concat(product.product_stocklist_id)},\"Count\"),/*#__PURE__*/React.createElement(\"div\",{className:\"modal\",id:\"id\".concat(product.product_stocklist_id)},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-dialog\"},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-header\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"modal-title\"},product.product_name)),/*#__PURE__*/React.createElement(\"div\",{className:\"modal-body\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"h5\",null,\"Add partial\"),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm\"},/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(\"input\",{value:partial,onChange:function onChange(e){return _onChange(e);},name:\"partial\",className:\"form-control mb-4\",type:\"number\",placeholder:\"0.00\",step:\"0.05\",min:\"0\",max:\"1.0\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-info\",onClick:addPartial},\"Add\"))),/*#__PURE__*/React.createElement(\"h5\",null,\"Add full\"),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-danger\",onClick:minusOne},/*#__PURE__*/React.createElement(\"h4\",null,\"-\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm\"},/*#__PURE__*/React.createElement(\"img\",{src:Bottle,alt:\"Bottle Image\",height:\"140\",width:\"140\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success\",onClick:addOne},/*#__PURE__*/React.createElement(\"h4\",null,\"+\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm\"},tempQuantity),/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"modal-footer\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success\",\"data-dismiss\":\"modal\",onClick:function onClick(e){return setProductQuantity(product.product_stocklist_id);}},\"Add\"))))));};export default CountModal;","map":{"version":3,"sources":["C:/Users/alans/bevstock/client/src/components/stocktaking/CountModal.js"],"names":["React","Fragment","useState","Bottle","useEffect","CountModal","product","setProductsChange","stocktakeid","setQuantity","setQuantityChange","partial","setPartial","tempQuantity","setTempQuantity","stocktake","Number","onChange","e","target","value","addPartial","addOne","minusOne","setProductQuantity","item","body","console","log","fetch","method","headers","JSON","stringify","response","json","parseRes","rows","quantity","error","message","product_stocklist_id","product_name"],"mappings":"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","sourcesContent":["import React, { Fragment, useState } from \"react\";\r\nimport Bottle from \"../../images/beer-bottle.png\";\r\nimport { useEffect } from \"react\";\r\n\r\n//Modal that opens when counting a particular product. Preoduct is passed in as props\r\nconst CountModal = ({ product, setProductsChange, stocktakeid, setQuantity, setQuantityChange }) => {\r\n  const [partial, setPartial] = useState(0);\r\n  const [tempQuantity, setTempQuantity] = useState(0);\r\n  const stocktake = Number(stocktakeid);\r\n\r\n  //Onchange for partial bottle form field\r\n  const onChange = (e) => {\r\n    setPartial(Number(e.target.value));\r\n  };\r\n\r\n  //Adds partial quantity to temporary quantity\r\n  const addPartial = () => {\r\n    setTempQuantity(Number(tempQuantity + partial));\r\n    setPartial(0);\r\n  };\r\n\r\n  //Adds one full bottle to temporary quantity\r\n  const addOne = () => {\r\n    setTempQuantity(Number(tempQuantity + 1));\r\n  };\r\n\r\n  //Subtracts one ful bottle from temporary quantity\r\n  const minusOne = () => {\r\n    setTempQuantity(Number(tempQuantity - 1));\r\n  };\r\n\r\n  // Should set product.quantity to the temp quantity value and zero out temp quantity after\r\n  const setProductQuantity = async (item) => {\r\n    try {\r\n      const body = { item, stocktake, tempQuantity };\r\n      console.log(body);\r\n      const response = await fetch(\"/stocktake/count\", {\r\n        method: \"PUT\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(body),\r\n      });\r\n\r\n      const parseRes = await response.json();\r\n\r\n      setQuantity(parseRes.rows[0].quantity);\r\n\r\n    } catch (error) {\r\n      console.error(error.message);\r\n    }\r\n    setTempQuantity(0);\r\n    setProductsChange(true);\r\n    setQuantityChange(true);\r\n    \r\n  };\r\n\r\n  useEffect(() => {}, [tempQuantity]);\r\n\r\n  return (\r\n    <Fragment>\r\n      <button\r\n        type=\"button\"\r\n        className=\"btn btn-info\"\r\n        data-toggle=\"modal\"\r\n        data-target={`#id${product.product_stocklist_id}`}\r\n      >\r\n        Count\r\n      </button>\r\n\r\n      <div className=\"modal\" id={`id${product.product_stocklist_id}`}>\r\n        <div className=\"modal-dialog\">\r\n          <div className=\"modal-content\">\r\n            <div className=\"modal-header\">\r\n              <h4 className=\"modal-title\">{product.product_name}</h4>\r\n            </div>\r\n            <div className=\"modal-body\"></div>\r\n            <div className=\"container\">\r\n              <h5>Add partial</h5>\r\n              <div className=\"row\">\r\n                <div className=\"col-sm\">\r\n                  <form>\r\n                    <input\r\n                      value={partial}\r\n                      onChange={(e) => onChange(e)}\r\n                      name=\"partial\"\r\n                      className=\"form-control mb-4\"\r\n                      type=\"number\"\r\n                      placeholder=\"0.00\"\r\n                      step=\"0.05\"\r\n                      min=\"0\"\r\n                      max=\"1.0\"\r\n                    ></input>\r\n                  </form>\r\n                </div>\r\n\r\n                <div className=\"col-sm\">\r\n                  <button className=\"btn btn-info\" onClick={addPartial}>\r\n                    Add\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <h5>Add full</h5>\r\n              <div className=\"row\">\r\n                <div className=\"col-sm\">\r\n                  <button className=\"btn btn-danger\" onClick={minusOne}>\r\n                    <h4>-</h4>\r\n                  </button>\r\n                </div>\r\n                <div className=\"col-sm\">\r\n                  <img\r\n                    src={Bottle}\r\n                    alt=\"Bottle Image\"\r\n                    height=\"140\"\r\n                    width=\"140\"\r\n    \r\n                />\r\n                </div>\r\n                <div className=\"col-sm\">\r\n                  <button className=\"btn btn-success\" onClick={addOne}>\r\n                    <h4>+</h4>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <div className=\"row\">\r\n                <div className=\"col-sm\"></div>\r\n                <div className=\"col-sm\">{tempQuantity}</div>\r\n                <div className=\"col-sm\"></div>\r\n              </div>\r\n            </div>\r\n            <div className=\"modal-footer\">\r\n              <button\r\n                className=\"btn btn-success\"\r\n                data-dismiss=\"modal\"\r\n                onClick={(e) => setProductQuantity(product.product_stocklist_id)}\r\n              >\r\n                Add\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default CountModal;\r\n"]},"metadata":{},"sourceType":"module"}