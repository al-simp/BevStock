{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React from\"react\";import{toast}from\"react-toastify\";import{useState}from\"react\";import{useEffect}from\"react\";import{AiOutlineHome}from\"react-icons/ai\";import{MdLocalBar}from\"react-icons/md\";import{RiScales2Fill}from\"react-icons/ri\";import{BsCardChecklist}from\"react-icons/bs\";//nav bar component for the admin site. \nvar Nav=function Nav(_ref){var setIsAuthenticated=_ref.setIsAuthenticated,isAuthenticated=_ref.isAuthenticated,name=_ref.name,userType=_ref.userType;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),stocktake=_useState2[0],setStocktake=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),latestInventoryId=_useState4[0],setLatestInventoryId=_useState4[1];// check is authenticated, otherwise nav will show when user is logged out. \nfunction isAuth(){return _isAuth.apply(this,arguments);}//logout method\nfunction _isAuth(){_isAuth=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,parseRes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"/auth/is-verify\",{method:\"GET\",headers:{token:localStorage.token}});case 3:response=_context.sent;_context.next=6;return response.json();case 6:parseRes=_context.sent;parseRes===true?setIsAuthenticated(true):setIsAuthenticated(false);_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.error(_context.t0.message);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return _isAuth.apply(this,arguments);}var logout=function logout(e){e.preventDefault();localStorage.clear();setIsAuthenticated(false);toast.success(\"Logged out successfully!\");};function findLastStocktake(){return _findLastStocktake.apply(this,arguments);}function _findLastStocktake(){_findLastStocktake=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,parseRes;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch(\"/inventory/latest\",{method:\"GET\",headers:{token:localStorage.token}});case 3:response=_context2.sent;_context2.next=6;return response.json();case 6:parseRes=_context2.sent;setLatestInventoryId(parseRes[0].stocktake_id);_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0.message);case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,10]]);}));return _findLastStocktake.apply(this,arguments);}function checkStocktake(){return _checkStocktake.apply(this,arguments);}function _checkStocktake(){_checkStocktake=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response,parseRes;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return fetch(\"/stocktake/activestocktake\",{method:\"GET\",headers:{token:localStorage.token}});case 3:response=_context3.sent;_context3.next=6;return response.json();case 6:parseRes=_context3.sent;if(parseRes.length>0){setStocktake(parseRes);localStorage.setItem(\"stocktake\",parseRes[0].stocktake_id);localStorage.setItem(\"stocktakedate\",parseRes[0].stocktake_date);}_context3.next=13;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](0);console.error(_context3.t0.message);case 13:case\"end\":return _context3.stop();}}},_callee3,null,[[0,10]]);}));return _checkStocktake.apply(this,arguments);}useEffect(function(){checkStocktake();findLastStocktake();isAuth();},[isAuthenticated]);return isAuthenticated&&userType==='Admin'?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"nav\",{className:\"navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0\"},/*#__PURE__*/React.createElement(\"a\",{href:\"#\",className:\"navbar-brand col-sm-3 col-md-2 mr-0\"},\"BevStock\"),/*#__PURE__*/React.createElement(\"ul\",{className:\"navbar-nav px-3\"},/*#__PURE__*/React.createElement(\"li\",{className:\"nav-item text-nowrap\"},/*#__PURE__*/React.createElement(\"a\",{className:\"nav-link\",onClick:function onClick(e){return logout(e);},href:\"#\"},name,\" : Sign out\")))),/*#__PURE__*/React.createElement(\"nav\",{className:\"col-md-2 d-none d-md-block bg-light sidebar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar-sticky\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"nav flex-column\"},/*#__PURE__*/React.createElement(\"li\",{className:\"nav-item\"},/*#__PURE__*/React.createElement(\"a\",{className:\"nav-link\",href:\"/dashboard\"},/*#__PURE__*/React.createElement(AiOutlineHome,null),\" Dashboard\",\" \",/*#__PURE__*/React.createElement(\"span\",{className:\"sr-only\"},\"(current)\"))),/*#__PURE__*/React.createElement(\"li\",{className:\"nav-item\"},/*#__PURE__*/React.createElement(\"a\",{className:\"nav-link\",href:\"/stocktaking\"},/*#__PURE__*/React.createElement(MdLocalBar,null),\" View/Edit Stock Areas\")),/*#__PURE__*/React.createElement(\"li\",{className:\"nav-item\"},/*#__PURE__*/React.createElement(\"a\",{className:\"nav-link\",href:\"/stocktakelists\"},/*#__PURE__*/React.createElement(RiScales2Fill,null),\"  Stocktaking\")),/*#__PURE__*/React.createElement(\"li\",{className:\"nav-item\"},/*#__PURE__*/React.createElement(\"a\",{className:\"nav-link\",href:\"/inventory/\".concat(latestInventoryId)},/*#__PURE__*/React.createElement(BsCardChecklist,null),\" Inventory\")),/*#__PURE__*/React.createElement(\"li\",{className:\"nav-item\"},/*#__PURE__*/React.createElement(\"a\",{className:\"nav-link\",href:\"/processdelivery\"},/*#__PURE__*/React.createElement(BsCardChecklist,null),\" Process Delivery\")),/*#__PURE__*/React.createElement(\"li\",{className:\"nav-item\"},/*#__PURE__*/React.createElement(\"a\",{className:\"nav-link\",href:\"/team\"},/*#__PURE__*/React.createElement(BsCardChecklist,null),\" Team Management\")),/*#__PURE__*/React.createElement(\"li\",{className:\"nav-item\"},/*#__PURE__*/React.createElement(\"a\",{className:\"nav-link\",href:\"/products\"},/*#__PURE__*/React.createElement(BsCardChecklist,null),\" Products Database\")))))):null;};export default Nav;","map":{"version":3,"sources":["C:/Users/alans/bevstock/client/src/components/Nav.js"],"names":["React","toast","useState","useEffect","AiOutlineHome","MdLocalBar","RiScales2Fill","BsCardChecklist","Nav","setIsAuthenticated","isAuthenticated","name","userType","stocktake","setStocktake","latestInventoryId","setLatestInventoryId","isAuth","fetch","method","headers","token","localStorage","response","json","parseRes","console","error","message","logout","e","preventDefault","clear","success","findLastStocktake","stocktake_id","checkStocktake","length","setItem","stocktake_date"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { toast } from \"react-toastify\";\r\nimport { useState } from \"react\";\r\nimport { useEffect } from \"react\";\r\nimport { AiOutlineHome } from \"react-icons/ai\";\r\nimport { MdLocalBar } from \"react-icons/md\";\r\nimport { RiScales2Fill } from \"react-icons/ri\";\r\nimport { BsCardChecklist } from \"react-icons/bs\";\r\n\r\n//nav bar component for the admin site. \r\n\r\nconst Nav = ({ setIsAuthenticated, isAuthenticated, name, userType }) => {\r\n  const [stocktake, setStocktake] = useState(false);\r\n  const [latestInventoryId, setLatestInventoryId] = useState(\"\");\r\n\r\n  // check is authenticated, otherwise nav will show when user is logged out. \r\n  async function isAuth() {\r\n    try {\r\n      const response = await fetch(\"/auth/is-verify\", {\r\n        method: \"GET\",\r\n        headers: { token: localStorage.token },\r\n      });\r\n\r\n      const parseRes = await response.json();\r\n\r\n      parseRes === true ? setIsAuthenticated(true) : setIsAuthenticated(false);\r\n    } catch (err) {\r\n      console.error(err.message);\r\n    }\r\n  }\r\n\r\n  //logout method\r\n  const logout = (e) => {\r\n    e.preventDefault();\r\n    localStorage.clear();\r\n    setIsAuthenticated(false);\r\n    toast.success(\"Logged out successfully!\");\r\n  };\r\n\r\n\r\n  async function findLastStocktake() {\r\n    try {\r\n      const response = await fetch(\"/inventory/latest\", {\r\n        method: \"GET\",\r\n        headers: { token: localStorage.token },\r\n      });\r\n      const parseRes = await response.json();\r\n      setLatestInventoryId(parseRes[0].stocktake_id);\r\n    } catch (error) {\r\n      console.error(error.message);\r\n    }\r\n  }\r\n\r\n  async function checkStocktake() {\r\n    try {\r\n      const response = await fetch(\r\n        \"/stocktake/activestocktake\",\r\n        {\r\n          method: \"GET\",\r\n          headers: { token: localStorage.token },\r\n        }\r\n      );\r\n\r\n      const parseRes = await response.json();\r\n\r\n      if (parseRes.length > 0) {\r\n        setStocktake(parseRes);\r\n        localStorage.setItem(\"stocktake\", parseRes[0].stocktake_id);\r\n        localStorage.setItem(\"stocktakedate\", parseRes[0].stocktake_date);\r\n      }\r\n    } catch (error) {\r\n      console.error(error.message);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    checkStocktake();\r\n    findLastStocktake();\r\n    isAuth();\r\n  }, [isAuthenticated]);\r\n  return isAuthenticated && userType === 'Admin' ? (\r\n    <div>\r\n      <nav className=\"navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0\">\r\n        <a href=\"#\" className=\"navbar-brand col-sm-3 col-md-2 mr-0\">\r\n          BevStock\r\n        </a>\r\n        <ul className=\"navbar-nav px-3\">\r\n          <li className=\"nav-item text-nowrap\">\r\n            <a className=\"nav-link\" onClick={(e) => logout(e)} href=\"#\">\r\n              {name} : Sign out\r\n            </a>\r\n          </li>\r\n        </ul>\r\n      </nav>\r\n      <nav className=\"col-md-2 d-none d-md-block bg-light sidebar\">\r\n        <div className=\"sidebar-sticky\">\r\n          <ul className=\"nav flex-column\">\r\n            <li className=\"nav-item\">\r\n              <a className=\"nav-link\" href={`/dashboard`}>\r\n                <AiOutlineHome /> Dashboard{\" \"}\r\n                <span className=\"sr-only\">(current)</span>\r\n              </a>\r\n            </li>\r\n            <li className=\"nav-item\">\r\n              <a className=\"nav-link\" href={`/stocktaking`}>\r\n                <MdLocalBar /> View/Edit Stock Areas\r\n              </a>\r\n            </li>\r\n            <li className=\"nav-item\">\r\n              <a className=\"nav-link\" href=\"/stocktakelists\">\r\n                <RiScales2Fill />  Stocktaking\r\n              </a>\r\n            </li>\r\n            <li className=\"nav-item\">\r\n              <a className=\"nav-link\" href={`/inventory/${latestInventoryId}`}>\r\n                <BsCardChecklist /> Inventory\r\n              </a>\r\n            </li>\r\n            <li className=\"nav-item\">\r\n              <a className=\"nav-link\" href={`/processdelivery`}>\r\n                <BsCardChecklist /> Process Delivery\r\n              </a>\r\n            </li>\r\n            <li className=\"nav-item\">\r\n              <a className=\"nav-link\" href={`/team`}>\r\n                <BsCardChecklist /> Team Management\r\n              </a>\r\n            </li>\r\n            <li className=\"nav-item\">\r\n              <a className=\"nav-link\" href={`/products`}>\r\n                <BsCardChecklist /> Products Database\r\n              </a>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </nav>\r\n    </div>\r\n  ) : null;\r\n};\r\n\r\nexport default Nav;\r\n"]},"metadata":{},"sourceType":"module"}