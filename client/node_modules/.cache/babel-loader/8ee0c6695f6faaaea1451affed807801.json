{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import MultiSelect from\"react-multi-select-component\";import{toast}from\"react-toastify\";var Dropdown=function Dropdown(_ref){var listId=_ref.listId,setQuantityChange=_ref.setQuantityChange;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),products=_useState2[0],setProducts=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),stocktakeBoo=_useState4[0],setStocktakeBoo=_useState4[1];var stockId=Number(localStorage.getItem(\"stocktake\"));var checkStocktake=function checkStocktake(){if(stockId!==0){setStocktakeBoo(true);}};var getProducts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,jsonData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"/products\");case 3:response=_context.sent;_context.next=6;return response.json();case 6:jsonData=_context.sent;setProducts(jsonData);_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.error(_context.t0.message);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function getProducts(){return _ref2.apply(this,arguments);};}();useEffect(function(){checkStocktake();getProducts();});var options=products.map(function(product){return{label:product.product_name,value:product.product_id};});var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),selected=_useState6[0],setSelected=_useState6[1];var addItemStocktake=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(item){var productId,body,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:productId=item.value;_context2.prev=1;body={productId:productId,listId:listId,stockId:stockId};_context2.next=5;return fetch(\"/stocklists/addproductstocktake\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)});case 5:response=_context2.sent;_context2.next=8;return response.json();case 8:setQuantityChange(true);toast.success(\"Products added succesfully\");_context2.next=15;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](1);console.error(_context2.t0.message);case 15:case\"end\":return _context2.stop();}}},_callee2,null,[[1,12]]);}));return function addItemStocktake(_x){return _ref3.apply(this,arguments);};}();var addItem=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(item){var productId,body,response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:productId=item.value;_context3.prev=1;body={productId:productId,listId:listId};_context3.next=5;return fetch(\"/stocklists/addproduct\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)});case 5:response=_context3.sent;_context3.next=8;return response.json();case 8:toast.success(\"Products Added Successfully!\");setQuantityChange(true);_context3.next=15;break;case 12:_context3.prev=12;_context3.t0=_context3[\"catch\"](1);console.log(_context3.t0.message);case 15:case\"end\":return _context3.stop();}}},_callee3,null,[[1,12]]);}));return function addItem(_x2){return _ref4.apply(this,arguments);};}();var onSubmitForm=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:e.preventDefault();if(stocktakeBoo){selected.forEach(addItemStocktake);}else{selected.forEach(addItem);}case 2:case\"end\":return _context4.stop();}}},_callee4);}));return function onSubmitForm(_x3){return _ref5.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:onSubmitForm},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-8\"},/*#__PURE__*/React.createElement(MultiSelect,{options:options,value:selected,onChange:setSelected,labelledBy:\"Select\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success\"},\"Add\")))));};export default Dropdown;","map":{"version":3,"sources":["C:/Users/alans/bevstock/client/src/components/stocktaking/Dropdown.js"],"names":["React","useState","useEffect","MultiSelect","toast","Dropdown","listId","setQuantityChange","products","setProducts","stocktakeBoo","setStocktakeBoo","stockId","Number","localStorage","getItem","checkStocktake","getProducts","fetch","response","json","jsonData","console","error","message","options","map","product","label","product_name","value","product_id","selected","setSelected","addItemStocktake","item","productId","body","method","headers","JSON","stringify","success","addItem","log","onSubmitForm","e","preventDefault","forEach"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport MultiSelect from \"react-multi-select-component\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst Dropdown = ({ listId, setQuantityChange }) => {\r\n  const [products, setProducts] = useState([]);\r\n  const [stocktakeBoo, setStocktakeBoo] = useState(false);\r\n\r\n  const stockId = Number(localStorage.getItem(\"stocktake\"));\r\n\r\n  const checkStocktake = () => {\r\n    if (stockId !== 0) {\r\n      setStocktakeBoo(true);\r\n    }\r\n  };\r\n\r\n  const getProducts = async () => {\r\n    try {\r\n      const response = await fetch(\"/products\");\r\n      const jsonData = await response.json();\r\n\r\n      setProducts(jsonData);\r\n    } catch (err) {\r\n      console.error(err.message);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    checkStocktake();\r\n    getProducts();\r\n  }, );\r\n\r\n  const options = products.map((product) => ({\r\n    label: product.product_name,\r\n    value: product.product_id,\r\n  }));\r\n  const [selected, setSelected] = useState([]);\r\n\r\n  const addItemStocktake = async (item) => {\r\n    let productId = item.value;\r\n    try {\r\n      const body = { productId, listId, stockId };\r\n      const response = await fetch(\r\n        \"/stocklists/addproductstocktake\",\r\n        {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify(body),\r\n        }\r\n      );\r\n      await response.json();\r\n      setQuantityChange(true);\r\n      toast.success(\"Products added succesfully\");\r\n    } catch (error) {\r\n      console.error(error.message);\r\n    }\r\n  };\r\n\r\n  const addItem = async (item) => {\r\n    let productId = item.value;\r\n    try {\r\n      const body = { productId, listId };\r\n      const response = await fetch(\r\n        \"/stocklists/addproduct\",\r\n        {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify(body),\r\n        }\r\n      );\r\n      await response.json();\r\n\r\n      toast.success(\"Products Added Successfully!\");\r\n      setQuantityChange(true);\r\n    } catch (err) {\r\n      console.log(err.message);\r\n    }\r\n  };\r\n\r\n  const onSubmitForm = async (e) => {\r\n    e.preventDefault();\r\n    if (stocktakeBoo) {\r\n      selected.forEach(addItemStocktake);\r\n    } else {\r\n      selected.forEach(addItem);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <form onSubmit={onSubmitForm}>\r\n        <div className=\"row\">\r\n          <div className=\"col-8\">\r\n            <MultiSelect\r\n              options={options}\r\n              value={selected}\r\n              onChange={setSelected}\r\n              labelledBy={\"Select\"}\r\n            />\r\n          </div>\r\n          <div className=\"col-4\">\r\n            <button className=\"btn btn-success\">Add</button>\r\n            \r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Dropdown;\r\n"]},"metadata":{},"sourceType":"module"}