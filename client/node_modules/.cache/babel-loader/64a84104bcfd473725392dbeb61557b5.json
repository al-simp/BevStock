{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\alans\\\\bevstock\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{Fragment,useState,useEffect}from\"react\";var AssignList=function AssignList(_ref){var name=_ref.name,stocklist_id=_ref.stocklist_id,setListsChange=_ref.setListsChange;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),users=_useState2[0],setUsers=_useState2[1];var stocktake_id=localStorage.getItem(\"stocktake\");var getTeamMembers=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,parseRes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"/teammanagement/users\",{method:\"GET\"});case 3:response=_context.sent;_context.next=6;return response.json();case 6:parseRes=_context.sent;setUsers(parseRes);_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.error(_context.t0.message);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function getTeamMembers(){return _ref2.apply(this,arguments);};}();function assignToUser(_x,_x2){return _assignToUser.apply(this,arguments);}function _assignToUser(){_assignToUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event,user){var userMessage,id,modal,modalBackdrops,body,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:event.preventDefault();userMessage=document.getElementById(user.user_id).value;console.log(user,userMessage);id=user.user_id;modal=document.getElementById(\"id\".concat(stocklist_id));modal.setAttribute(\"style\",\"display: none\");modalBackdrops=document.getElementsByClassName(\"modal-backdrop\");document.body.removeChild(modalBackdrops[0]);_context2.prev=8;body={stocklist_id:stocklist_id,stocktake_id:stocktake_id,id:id,userMessage:userMessage};_context2.next=12;return fetch(\"/stocklists/assignlist\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body)});case 12:response=_context2.sent;_context2.next=15;return response.json();case 15:setListsChange(true);_context2.next=21;break;case 18:_context2.prev=18;_context2.t0=_context2[\"catch\"](8);console.error(_context2.t0.message);case 21:case\"end\":return _context2.stop();}}},_callee2,null,[[8,18]]);}));return _assignToUser.apply(this,arguments);}useEffect(function(){getTeamMembers();},[]);return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-info\",\"data-toggle\":\"modal\",\"data-target\":\"#id\".concat(stocklist_id)},\"Assign\"),/*#__PURE__*/React.createElement(\"div\",{className:\"modal\",id:\"id\".concat(stocklist_id)},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-dialog\"},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-header\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"modal-title\"},name)),/*#__PURE__*/React.createElement(\"div\",{className:\"modal-body\"}),/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"Name\"),/*#__PURE__*/React.createElement(\"th\",null,\"Message\"))),/*#__PURE__*/React.createElement(\"tbody\",null,users.map(function(user){return/*#__PURE__*/React.createElement(\"tr\",{key:user.user_id},/*#__PURE__*/React.createElement(\"td\",null,user.user_name),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){assignToUser(e,user);}},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-7\"},/*#__PURE__*/React.createElement(\"textarea\",{className:\"form-control\",id:\"\".concat(user.user_id)})),/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success float-right\",type:\"submit\"},\"Assign\"))))));}))),/*#__PURE__*/React.createElement(\"div\",{className:\"modal-footer\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success\",\"data-dismiss\":\"modal\"},\"Close\"))))));};export default AssignList;","map":{"version":3,"sources":["C:/Users/alans/bevstock/client/src/components/stocktaking/AssignList.js"],"names":["React","Fragment","useState","useEffect","AssignList","name","stocklist_id","setListsChange","users","setUsers","stocktake_id","localStorage","getItem","getTeamMembers","fetch","method","response","json","parseRes","console","error","message","assignToUser","event","user","preventDefault","userMessage","document","getElementById","user_id","value","log","id","modal","setAttribute","modalBackdrops","getElementsByClassName","body","removeChild","headers","JSON","stringify","map","user_name","e"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useEffect } from \"react\";\r\n\r\nconst AssignList = ({ name, stocklist_id, setListsChange }) => {\r\n  const [users, setUsers] = useState([]);\r\n  const stocktake_id = localStorage.getItem(\"stocktake\");\r\n\r\n  const getTeamMembers = async () => {\r\n    try {\r\n      const response = await fetch(\r\n        \"/teammanagement/users\",\r\n        {\r\n          method: \"GET\",\r\n        }\r\n      );\r\n\r\n      const parseRes = await response.json();\r\n      setUsers(parseRes);\r\n    } catch (error) {\r\n      console.error(error.message);\r\n    }\r\n  };\r\n\r\n  async function assignToUser(event, user) {\r\n    event.preventDefault();\r\n    const userMessage = document.getElementById(user.user_id).value;\r\n    console.log(user, userMessage);\r\n    const id = user.user_id;\r\n\r\n    const modal = document.getElementById(`id${stocklist_id}`);\r\n\r\n    modal.setAttribute(\"style\", \"display: none\");\r\n    const modalBackdrops = document.getElementsByClassName(\"modal-backdrop\");\r\n    document.body.removeChild(modalBackdrops[0]);\r\n\r\n    try {\r\n      const body = { stocklist_id, stocktake_id, id, userMessage };\r\n      const response = await fetch(\r\n        \"/stocklists/assignlist\",\r\n        {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify(body),\r\n        }\r\n      );\r\n      await response.json();\r\n      setListsChange(true);\r\n    } catch (error) {\r\n      console.error(error.message);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    getTeamMembers();\r\n  }, []);\r\n\r\n  return (\r\n    <Fragment>\r\n      <button\r\n        type=\"button\"\r\n        className=\"btn btn-info\"\r\n        data-toggle=\"modal\"\r\n        data-target={`#id${stocklist_id}`}\r\n      >\r\n        Assign\r\n      </button>\r\n      <div className=\"modal\" id={`id${stocklist_id}`}>\r\n        <div className=\"modal-dialog\">\r\n          <div className=\"modal-content\">\r\n            <div className=\"modal-header\">\r\n              <h4 className=\"modal-title\">{name}</h4>\r\n            </div>\r\n            <div className=\"modal-body\"></div>\r\n            <table className=\"table\">\r\n              <thead>\r\n                <tr>\r\n                  <th>Name</th>\r\n                  <th>Message</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {users.map((user) => (\r\n                  <tr key={user.user_id}>\r\n                    <td>{user.user_name}</td>\r\n                    <td>\r\n                      <form\r\n                        onSubmit={(e) => {\r\n                          assignToUser(e, user);\r\n                        }}\r\n                      >\r\n                        <div className=\"row\">\r\n                          <div className=\"col-7\">\r\n                            <textarea\r\n                              className=\"form-control\"\r\n                              id={`${user.user_id}`}\r\n                            />\r\n                          </div>\r\n                          <div className=\"col\">\r\n                            <button\r\n                              className=\"btn btn-success float-right\"\r\n                              type=\"submit\"\r\n                            >\r\n                              Assign\r\n                            </button>\r\n                          </div>\r\n                        </div>\r\n                      </form>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n            <div className=\"modal-footer\">\r\n              <button className=\"btn btn-success\" data-dismiss=\"modal\">\r\n                Close\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default AssignList;\r\n"]},"metadata":{},"sourceType":"module"}